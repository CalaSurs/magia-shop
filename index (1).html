<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Magia.lol ‚Äî Juegos Online</title>
<meta name="description" content="Juega juegos HTML5 gratis y publica el tuyo por iframe.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg1:#2d0b63; --bg2:#041f49; --card:#12131a; --ink:#f5f7ff; --muted:#aab3c5;
    --pri:#7c3aed; --pri-2:#5b21b6; --accent:#22d3ee;
    --radius:18px; --shadow:0 10px 35px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:'Poppins',system-ui,Segoe UI,Roboto,sans-serif;background:linear-gradient(120deg,var(--bg1),var(--bg2)) fixed;color:var(--ink);min-height:100vh;display:flex;flex-direction:column}
  a{color:inherit}
  header{position:sticky;top:0;background:rgba(8,10,20,.6);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.07);z-index:10}
  .wrap{max-width:1200px;margin:0 auto;padding:16px 20px}
  .row{display:flex;gap:16px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .brand{display:flex;align-items:center;gap:10px;font-weight:800;font-size:1.25rem}
  .brand b{background:linear-gradient(90deg,#fff,#a78bfa,#60a5fa,#34d399);-webkit-background-clip:text;background-clip:text;color:transparent}
  .nav{display:flex;gap:10px;flex-wrap:wrap}
  .btn{background:var(--pri);border:none;color:#fff;border-radius:12px;padding:10px 14px;font-weight:700;text-decoration:none}
  .btn:hover{background:var(--pri-2)}
  .ghost{background:transparent;border:1px solid rgba(255,255,255,.15)}
  .hero{padding:28px 20px 10px}
  .hero h1{margin:0 0 8px;font-size:2.25rem;letter-spacing:.2px}
  .hero p{margin:0;color:var(--muted)}
  .filters{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
  .tag{padding:8px 12px;border:1px solid rgba(255,255,255,.15);border-radius:999px;color:#e5e9f7;cursor:pointer}
  .tag.active,.tag:hover{background:rgba(255,255,255,.1)}
  main{flex:1}
  .grid{display:grid;gap:16px;padding:22px 20px;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));max-width:1200px;margin:0 auto}
  .card{background:rgba(1,4,12,.55);border:1px solid rgba(255,255,255,.07);border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column}
  .thumb{aspect-ratio:16/9;background:linear-gradient(135deg,rgba(255,255,255,.06),rgba(255,255,255,.02));display:flex;align-items:center;justify-content:center;font-size:44px}
  .meta{padding:12px 14px}
  .title{font-weight:700;margin:0 0 6px;font-size:1rem}
  .kicker{font-size:.82rem;color:var(--muted);margin-bottom:10px}
  .play{margin-top:auto;display:flex;justify-content:space-between;align-items:center;gap:8px}
  .play a{display:inline-block;background:var(--accent);color:#0b1020;text-decoration:none;padding:9px 12px;border-radius:10px;font-weight:800}
  .pill{font-size:.75rem;padding:6px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.15);color:#cfe4ff}
  footer{border-top:1px solid rgba(255,255,255,.07);color:#cdd6ec}
  footer .wrap{padding:18px 20px}
  .disabled{opacity:.6;pointer-events:none}
  .notice{margin-top:10px;font-size:.9rem;color:#cfe4ff}
</style>
</head>
<body>
  <header>
    <div class="wrap row">
      <div class="brand">üïπÔ∏è <b>Magia.lol</b> ‚Äî Juegos</div>
      <nav class="nav">
        <a class="btn ghost" href="/submit.html">Publicar tu juego</a>
        <a class="btn" href="#catalogo">Cat√°logo</a>
      </nav>
    </div>
  </header>

  <section class="wrap hero">
    <h1>Juegos HTML5 gratis</h1>
    <p>Explora el cat√°logo, o <a href="/submit.html"><u>publica tu juego por iframe</u></a> para que aparezca aqu√≠ con tu nombre.</p>
    <div class="filters" id="filters">
      <button class="tag active" data-cat="all">Todos</button>
      <button class="tag" data-cat="accion">Acci√≥n</button>
      <button class="tag" data-cat="carreras">Carreras</button>
      <button class="tag" data-cat="puzzle">Puzzle</button>
      <button class="tag" data-cat="deportes">Deportes</button>
    </div>
    <div class="notice">üí° Los primeros juegos son ejemplos (GameMonetize). M√°s abajo ver√°s los juegos enviados por la comunidad.</div>
  </section>

  <main id="catalogo">
    <div id="grid" class="grid"></div>
  </main>

  <footer>
    <div class="wrap">¬© 2025 Magia.lol ‚Äî Inspirado en los portales de juegos. <span id="fb-status"></span></div>
  </footer>

<script>
// ====== CONFIG OPCIONAL DE FIREBASE (para juegos subidos por usuarios) ======
// 1) Crea un proyecto en https://console.firebase.google.com/ (plan gratuito "Spark")
// 2) Habilita Firestore (modo producci√≥n).
// 3) Copia aqu√≠ tu config de Firebase Web y cambia USE_FIREBASE=true.
// 4) En Firestore crea la colecci√≥n "games" con campos: title, iframe, author, cat (opcional), createdAt.
// 5) Seguridad b√°sica (para pruebas): en Reglas, permitir read: true; write: true (luego ajusta).

const USE_FIREBASE = false; // ‚Üê CAMBIA A true cuando pegues tu config abajo
const firebaseConfig = {
  // apiKey: "TU_API_KEY",
  // authDomain: "tu-proyecto.firebaseapp.com",
  // projectId: "tu-proyecto",
  // storageBucket: "tu-proyecto.appspot.com",
  // messagingSenderId: "000000000000",
  // appId: "1:000000000000:web:xxxxxxxxxxxxxx"
};

// ====== JUEGOS BASE (editor elegidos / est√°ticos) ======
const STATIC_GAMES = [
  { title:"City Car Driving", slug:"/juego-1.html", cat:"carreras", emoji:"üöó", author:"Magia" },
  { title:"Crowd Runners 3D", iframe:"https://html5.gamemonetize.com/hbq0b5rg2o4t2b9xq9f2x4r8r9m4l6b8/", cat:"accion", emoji:"üïπÔ∏è", author:"GM" },
  { title:"Monster Truck Racing", iframe:"https://html5.gamemonetize.com/3c4m2k4k2d9e2f2g/", cat:"carreras", emoji:"üöô", author:"GM" },
  { title:"Halloween Match Trio", iframe:"https://html5.gamemonetize.com/0yq8r5ab2m1n3u7i/", cat:"puzzle", emoji:"üéÉ", author:"GM" },
  { title:"Crazy Kick Ball", iframe:"https://html5.gamemonetize.com/5v6b7n8m9cx2as1d/", cat:"deportes", emoji:"‚öΩ", author:"GM" }
];

const grid = document.getElementById("grid");
const tagButtons = [...document.querySelectorAll(".tag")];
let activeCat = "all";

function cardHTML(g){
  const hasSlug = !!g.slug;
  const playHref = hasSlug ? g.slug : "#";
  const iframeLink = !hasSlug && g.iframe ? `/submit.html#preview=${encodeURIComponent(g.iframe)}` : null;
  return `
  <article class="card">
    <div class="thumb">${g.emoji || "üéÆ"}</div>
    <div class="meta">
      <h3 class="title">${g.title || "Juego"}</h3>
      <div class="kicker">Por: <span class="pill">${g.author || "An√≥nimo"}</span> ‚Ä¢ <span class="pill">${g.cat || "sin-categor√≠a"}</span></div>
      <div class="play">
        ${hasSlug
          ? `<a href="${playHref}">Jugar</a>`
          : (iframeLink ? `<a href="${iframeLink}">Abrir</a>` : `<a class="disabled">Sin enlace</a>`)}
        ${!hasSlug && g.iframe ? `<span class="kicker">Embed</span>` : ""}
      </div>
    </div>
  </article>`;
}

function render(list){
  grid.innerHTML = "";
  list
    .filter(g => activeCat === "all" || g.cat === activeCat)
    .forEach(g => grid.insertAdjacentHTML("beforeend", cardHTML(g)));
}

async function init(){
  // est√°ticos primero
  let list = [...STATIC_GAMES];
  if(USE_FIREBASE){
    try{
      document.getElementById("fb-status").textContent = "‚Äî Conectado a base de datos";
      const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js');
      const { getFirestore, collection, getDocs, query, orderBy } = await import('https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js');
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const snap = await getDocs(query(collection(db,'games'), orderBy('createdAt','desc')));
      snap.forEach(doc => {
        const d = doc.data();
        list.push({ title:d.title, iframe:d.iframe, author:d.author, cat:d.cat||'otros', emoji:'üÜï' });
      });
    }catch(e){
      document.getElementById("fb-status").textContent = "‚Äî Error BD (revisa config)";
      console.error(e);
    }
  } else {
    document.getElementById("fb-status").textContent = "‚Äî Modo sin base de datos";
  }
  render(list);
}

tagButtons.forEach(b => b.addEventListener("click", () => {
  tagButtons.forEach(x => x.classList.remove("active"));
  b.classList.add("active");
  activeCat = b.dataset.cat;
  init();
}));

init();
</script>

</body>
</html>
